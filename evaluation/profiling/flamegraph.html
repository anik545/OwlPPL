<!DOCTYPE html>
<html>
<head>
<title>flamebearer</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
    html, body { height: 100%; }
    body { font: 16px "Helvetica Neue", sans-serif; margin: 0; }
    body.hover { background: #cfc; }
    h1 { font-size: 30px; margin: 30px 30px 15px; }
    h1 a { color: black; text-decoration: none; }
    h1 a:hover { text-decoration: underline; }
    #fire-icon { fill: #f53; width: 26px; height: 26px; vertical-align: -1px; }
    #intro { margin: 0 30px; }
    code { font-size: 13px; color: #444; }
    code span { color: #aaa; }
    #canvas { width: 100%; }
    #controls { display: none; }
    #search { margin-right: 10px; }
    #highlight { position: absolute; pointer-events: none; background: #ffffff40; }
    .loaded #intro { display: none; }
    .loaded #header { display: flex; align-items: center; flex-flow: row wrap; padding: 7px 10px; }
    .loaded h1 { font-size: 22px; margin: 0 auto 0 0; flex-shrink: 0; }
    .loaded #fire-icon { width: 20px; height: 20px; }
    .loaded #controls { display: block; flex-shrink: 0; }
    #tooltip { position: absolute; pointer-events: none; background: #ffffff; white-space: nowrap; box-shadow: 1px 2px 4px 0px rgba(0,0,0,0.3); border-radius: 2px; padding: 3px 5px; font: 12px Tahoma, sans-serif; display: none; }
    #tooltip .path { color: #888; font-size: 11px; }
    #tooltip .time { color: #4a4; }
</style>
</head>
<body>

<div id="header">
    <h1><svg id="fire-icon" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15 15" style="enable-background:new 0 0 15 15;" xml:space="preserve"><path d="M7.5,0.5L5,4.5l-1.5-2 C2.9452,3.4753,0.8036,5.7924,0.8036,8.3036C0.8036,12.002,3.8017,15,7.5,15s6.6964-2.998,6.6964-6.6964 c0-2.5112-2.1416-4.8283-2.6964-5.8036l-1.5,2L7.5,0.5z M7.5,7c0,0,2.5,2.5618,2.5,4.5c0,0.8371-0.8259,2-2.5,2S5,12.3371,5,11.5 C5,9.6283,7.5,7,7.5,7z"/></svg> <a href="https://github.com/mapbox/flamebearer">flamebearer</a></h1>
    <div id="controls">
        <input id="search" placeholder="Search..." />
        <button id="reset">Reset view</button>
    </div>
</div>
<div id="highlight"></div>
<div id="tooltip"></div>
<div id="intro"><!--  --></div>
<canvas id="canvas" height="0"></canvas>

<!--  -->
<script>'use strict';

const introEl = document.getElementById('intro');
const searchEl = document.getElementById('search');
const highlightEl = document.getElementById('highlight');
const tooltipEl = document.getElementById('tooltip');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let names, levels, numTicks;

names = ["(unknown)","~(anonymous) bootstrap_node.js:10:10","~startup bootstrap_node.js:24:19","~setupGlobalVariables bootstrap_node.js:268:32","~NativeModule.require bootstrap_node.js:533:34","~NativeModule.compile bootstrap_node.js:601:44","~(anonymous) util.js:1:11","(C++) v8::internal::Runtime_CreateObjectLiteral(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Map::CopyWithField(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::Name>, v8::internal::Handle<v8::internal::FieldType>, v8::internal::PropertyAttributes, v8::internal::PropertyConstness, v8::internal::Representation, v8::internal::TransitionFlag)","(unknown)","~setupNextTick internal./process/next_tick.js:49:23","~(anonymous) internal./async_hooks.js:1:11","(C++) v8::internal::Heap::AllocateMap(v8::internal::InstanceType, int, v8::internal::ElementsKind)","~(anonymous) internal./trace_events_async_hooks.js:1:11","~(anonymous) async_hooks.js:1:11","(bytecode) ~Add.Wide","~setupGlobalConsole bootstrap_node.js:323:30","~(anonymous) module.js:1:11","~(anonymous) internal./loader/Loader.js:1:11","~(anonymous) internal./loader/ModuleMap.js:1:11","~(anonymous) internal./loader/ModuleJob.js:1:11","~(anonymous) internal./safe_globals.js:1:11","~makeSafe internal./safe_globals.js:15:18","~copyProps internal./safe_globals.js:3:19","(C++) v8::internal::Builtin_ObjectDefineProperty(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::HashTable<v8::internal::NameDictionary, v8::internal::NameDictionaryShape>::EnsureCapacity(v8::internal::Handle<v8::internal::NameDictionary>, int, v8::internal::PretenureFlag)","~(anonymous) console.js:1:11","~getStdout internal./process/stdio.js:14:21","~createWritableStdioStream internal./process/stdio.js:138:35","~(anonymous) tty.js:1:11","~(anonymous) net.js:1:11","~(anonymous) dns.js:1:11","~setExportsFunctions dns.js:371:29","(builtin) ArrayForEach","~resolverKeys.forEach dns.js:372:24","(C++) v8::internal::Runtime_KeyedLoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::StackFrame::GetCallerState(v8::internal::StackFrame::State*) const","~WriteStream tty.js:62:21","~Socket net.js:189:16","~Duplex _stream_duplex.js:47:16","~Writable _stream_writable.js:194:18","~WritableState _stream_writable.js:41:23","(C++) v8::internal::Runtime_StoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::StackFrameIterator::StackFrameIterator(v8::internal::Isolate*)","~getStderr internal./process/stdio.js:26:21","~addListener events.js:296:58","~_addListener events.js:233:22","(C++) v8::internal::Runtime_KeyedStoreIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::MapUpdater::BuildDescriptorArray()","~Module.runMain module.js:692:26","~Module._load module.js:448:24","~Module module.js:69:16","~tryModuleLoad module.js:503:23","~Module.load module.js:557:33","~Module._extensions..js module.js:662:37","~Module._compile module.js:610:37","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:1:11","~require internal./module.js:8:19","~Module.require module.js:594:36","~(anonymous) ./usr/lib/node_modules/webppl/src/main.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/ast-types/main.js:1:11","~Module._nodeModulePaths module.js:304:37","~resolve path.js:1156:28","(bytecode) ~LdaNamedProperty","~Module._resolveFilename module.js:515:35","~Module._findPath module.js:182:28","(builtin) CallFunction_ReceiverIsNullOrUndefined","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/fork.js:1:89","~use ./usr/lib/node_modules/webppl/node_modules/ast-types/fork.js:6:17","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/core.js:1:89","~fs.readFileSync fs.js:548:27","~tryReadSync fs.js:536:21","~fs.readSync fs.js:670:23","(C++) v8::internal::Builtin_HandleApiCall(int, v8::internal::Object**, v8::internal::Isolate*)","~Type.or ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:172:24","~toType ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:129:20","~Type ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:18:18","(C++) v8::internal::Builtin_ObjectDefineProperties(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::LookupIterator::State v8::internal::LookupIterator::LookupInRegularHolder<false>(v8::internal::Map*, v8::internal::JSReceiver*) [clone .part.78]","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/es6.js:1:89","~Dp.build ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:507:25","(C++) v8::internal::BinarySearch","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/es7.js:1:89","~Dp.field ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:641:25","~Field ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:223:19","(C++) v8::internal::Heap::CopyJSObject(v8::internal::JSObject*, v8::internal::AllocationSite*)","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/e4x.js:1:89","~Type.fromArray ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:188:31","(builtin) CallFunction_ReceiverIsAny","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/flow.js:1:89","(C++) v8::internal::LookupIterator::GetDataValue() const","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/babel.js:1:89","~Type.def ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:269:25","~Def ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:280:17","(C++) v8::internal::MaybeHandle<v8::internal::JSObject> v8::internal::(anonymous namespace)::CreateLiteral<v8::internal::(anonymous namespace)::ObjectBoilerplate>(v8::internal::Isolate*, v8::internal::Handle<v8::internal::JSFunction>, int, v8::internal::Handle<v8::internal::HeapObject>, int)","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/babel6.js:1:89","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/def/babel6-core.js:1:89","(C++) v8::internal::Runtime_SetProperty(int, v8::internal::Object**, v8::internal::Isolate*)","~exports.finalize ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:828:33","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:829:48","~Dp.finalize ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:712:28","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:721:45","~populateSupertypeList ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:784:35","(C++) v8::internal::LookupIterator::ApplyTransitionToDataProperty(v8::internal::Handle<v8::internal::JSObject>)","~extend ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:820:20","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/types.js:821:44","(C++) v8::internal::FixedArray::set(int, v8::internal::Object*, v8::internal::WriteBarrierMode)","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/node-path.js:1:89","~module.exports ./usr/lib/node_modules/webppl/node_modules/ast-types/lib/scope.js:3:27","(builtin) LoadIC_Uninitialized","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1:11","~webpackUniversalModuleDefinition ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1:105","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:12:18","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:13:26","~__webpack_require__ ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:18:39","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:58:15","~exports.Syntax.AssignmentExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:163:15","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:316:15","(C++) v8::internal::Heap::RecordWrite(v8::internal::Object*, v8::internal::Object**, v8::internal::Object*)","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/escodegen/escodegen.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/escodegen/escodegen.js:37:11","~getOptions fs.js:64:20","~assertEncoding internal./fs.js:19:24","~Buffer.isEncoding buffer.js:416:29","~normalizeEncoding internal./util.js:85:27","(bytecode) ~Return","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esutils/lib/utils.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esutils/lib/utils.js:26:11","~stat module.js:50:14","(builtin) MapSet","(C++) v8::internal::Runtime_MapGrow(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Heap::AllocateFixedArrayWithFiller(int, v8::internal::PretenureFlag, v8::internal::Object*)","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:9:11","~runInContext ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:1406:44","~memoizeCapped ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6424:27","~memoize ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:10540:21","~MapCache ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2125:22","~mapCacheClear ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2143:27","(bytecode) ~StaNamedOwnProperty","(C++) v8::internal::Map::RawCopy(v8::internal::Handle<v8::internal::Map>, int)","~arrayEach ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:511:21","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:16869:41","(C++) v8::internal::Heap::AllocateWeakCell(v8::internal::HeapObject*)","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:17025:78","(builtin) RegExpPrototypeTest","(C++) v8::internal::Runtime_RegExpExec(int, v8::internal::Object**, v8::internal::Isolate*)","(lib) /lib/x86_64-linux-gnu/libc-2.23.so","~tryExtensions module.js:170:23","~tryFile module.js:155:17","~toRealPath module.js:163:20","~realpathSync fs.js:1579:40","(bytecode) ~AddSmi","~(anonymous) ./usr/lib/node_modules/webppl/src/transforms/optimize.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/esmangle.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/esmangle.js:28:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esshorten/lib/esshorten.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esshorten/lib/esshorten.js:27:11","~Module._resolveLookupPaths module.js:345:38","(builtin) StringEqual","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/escope/escope.js:1:11","~Syntax ./usr/lib/node_modules/webppl/node_modules/escope/escope.js:50:11","~dirname path.js:1345:28","(builtin) StringPrototypeSlice","(bytecode) ~JumpIfTrue","~Module._extensions..json module.js:669:39","(C++) v8::internal::Builtin_JsonParse(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::JsonParser<true>::ParseJsonObject()","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/common.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/common.js:27:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/pass.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/pass.js:28:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/pass/reduce-sequence-expression.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/pass/reduce-sequence-expression.js:27:11","~tryStatSync fs.js:514:21","(C++) v8::internal::Runtime_KeyedGetProperty(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::KeyedGetObjectProperty(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>)","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/post/transform-infinity.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/esmangle/lib/post/transform-infinity.js:28:11","~isAbsolute path.js:1221:34","(bytecode) ~Mov","(C++) v8::internal::LookupIterator::PropertyOrElement(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>, bool*, v8::internal::LookupIterator::Configuration)","~(anonymous) ./usr/lib/node_modules/webppl/src/transforms/naming.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/seedrandom/index.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/seedrandom/seedrandom.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/seedrandom/seedrandom.js:25:11","~runInThisContext bootstrap_node.js:512:28","~Script.runInThisContext vm.js:46:45","(C++) node::(anonymous namespace)::ContextifyScript::RunInThisContext(v8::FunctionCallbackInfo<v8::Value> const&)","~(anonymous) crypto.js:1:1","(C++) v8::internal::Runtime_InterpreterNewClosure(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::PagedSpace::AllocateRawUnaligned(int, v8::internal::PagedSpace::UpdateSkipList)","~(anonymous) ./usr/lib/node_modules/webppl/src/ad.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/index.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/graph.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/tensor.js:1:11","(bytecode) ~CreateUnmappedArguments","~addBinaryMethod ./usr/lib/node_modules/webppl/node_modules/adnn/tensor.js:183:25","~join native array.js:287:46","~InnerArrayJoin native array.js:274:24","~Join native array.js:119:14","(bytecode) ~Jump","~normalizeStringPosix path.js:101:30","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:1:11","(bytecode) ~CallProperty1","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/derivatives.js:1:11","~makeUnaryDerivatives ./usr/lib/node_modules/webppl/node_modules/adnn/ad/derivatives.js:8:30","(stub) CEntryStub","~(anonymous) :1:1","(C++) v8::internal::Factory::NewFunction(v8::internal::Handle<v8::internal::Map>, v8::internal::Handle<v8::internal::SharedFunctionInfo>, v8::internal::Handle<v8::internal::Object>, v8::internal::PretenureFlag)","~(anonymous) ./usr/lib/node_modules/webppl/src/transforms/store.js:1:11","(bytecode) ~LdaSmi","~Buffer.toString buffer.js:609:37","~(anonymous) ./usr/lib/node_modules/webppl/src/transforms/trampoline.js:1:11","~parse ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:88:16","~Parser.parseProgram ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:3057:47","~Parser.parseStatementListItem ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1787:57","~Parser.parseStatement ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2486:49","~Parser.parseExpressionStatement ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2077:59","~Parser.parseExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1769:50","~Parser.isolateCoverGrammar ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:810:54","~Parser.parseAssignmentExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1700:60","~Parser.parseConditionalExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1604:61","~Parser.inheritCoverGrammar ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:826:54","~Parser.parseBinaryExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1556:56","~Parser.parseExponentiationExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1521:64","~Parser.parseUnaryExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1502:55","~Parser.parseUpdateExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1463:56","~Parser.parseLeftHandSideExpressionAllowCall ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1374:71","~Parser.parsePrimaryExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:853:57","~Parser.parseGroupExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1213:55","~Parser.parseFunctionExpression ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2724:58","~Parser.parseFunctionSourceElements ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2570:62","~Parser.expect ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:713:41","~Parser.nextToken ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:624:44","(IC) A store IC from the snapshot","~Parser.parseReturnStatement ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2327:55","~Parser.parseLabelledStatement ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:2403:57","~Parser.parseArguments ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:1319:49","~Parser.collectComments ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:557:50","~Scanner.scanComments ./usr/lib/node_modules/webppl/node_modules/esprima/dist/esprima.js:3635:48","~(anonymous) ./usr/lib/node_modules/webppl/src/transforms/caching.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/errors/errors.js:1:11","~tryPackage module.js:135:20","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/source-map/source-map.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/source-map/lib/source-map-generator.js:1:11","(builtin) InterpreterEntryTrampoline","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/source-map/lib/source-map-consumer.js:1:11","~basename path.js:1374:30","(C++) v8::internal::Runtime_Interrupt(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::StackGuard::HandleInterrupts()","~(anonymous) ./usr/lib/node_modules/webppl/src/params/params.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/params/config.js:1:11","~extname path.js:1452:28","(bytecode) ~TestEqualStrict","~(anonymous) ./usr/lib/node_modules/webppl/src/params/store/file.js:1:11","(bytecode) ~CallProperty2","~(anonymous) ./usr/lib/node_modules/webppl/src/header.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/nn/index.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/nn/networks/linear.js:1:11","(C++) v8::internal::JSObject::MigrateToMap(v8::internal::Handle<v8::internal::JSObject>, v8::internal::Handle<v8::internal::Map>, int)","(C++) operator delete[](void*)","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/index.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/base.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/beta.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/gaussian.js:1:11","dirname path.js:1345:28","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/binomial.js:1:11","~makeDistributionType ./usr/lib/node_modules/webppl/src/dists/base.js:83:30","~mergeDefaults ./usr/lib/node_modules/webppl/src/util.js:171:23","~clone ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:11029:19","~baseClone ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2620:23","~baseAssign ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2524:24","~copyObject ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:4760:24","~assignValue ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2471:25","~baseAssignValue ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2550:29","(IC) A keyed store IC from the snapshot","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/dirichlet.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/gamma.js:1:11","(C++) v8::internal::String::ComputeAndSetHash()","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/improperUniform.js:1:11","(C++) v8::internal::DescriptorArray::CopyUpToAddAttributes(v8::internal::Handle<v8::internal::DescriptorArray>, int, v8::internal::PropertyAttributes, int) [clone .constprop.665]","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/ispNormal.js:1:11","(bytecode) ~ToBooleanLogicalNot","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/kde.js:1:11","~tryCreateBuffer fs.js:524:25","~Buffer.allocUnsafe buffer.js:252:30","~allocate buffer.js:281:18","~FastBuffer buffer.js:37:14","~Uint8Array native typedarray.js:158:31","(builtin) TypedArrayConstructByArrayBuffer","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/randomInteger.js:1:11","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6548:22","~flatten ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:7325:21","~baseFlatten ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2933:25","~wrapperValue ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:9049:26","~baseWrapperValue ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:4362:30","~arrayReduce ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:675:23","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:4367:43","~mapValues ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:13396:23","~baseForOwn ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2989:24","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:4897:22","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:13400:34","(bytecode) ~StackCheck","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/rejection.js:1:11","(builtin) Call_ReceiverIsAny","~runInThisContext vm.js:138:26","(C++) v8::internal::MaybeHandle<v8::internal::Object> v8::internal::(anonymous namespace)::HandleApiCallHelper<false>(v8::internal::Isolate*, v8::internal::Handle<v8::internal::HeapObject>, v8::internal::Handle<v8::internal::HeapObject>, v8::internal::Handle<v8::internal::FunctionTemplateInfo>, v8::internal::Handle<v8::internal::Object>, v8::internal::BuiltinArguments)","~requireHeaderWrapper ./usr/lib/node_modules/webppl/src/main.js:33:30","~module.exports ./usr/lib/node_modules/webppl/src/header.js:56:26","~(anonymous) ./usr/lib/node_modules/webppl/src/header.js:193:33","~module.exports ./usr/lib/node_modules/webppl/src/inference/mcmc.js:9:26","~fs.openSync fs.js:642:23","~module.exports ./usr/lib/node_modules/webppl/src/inference/kernels.js:7:26","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/hmckernel.js:1:11","~updateChildren module.js:63:24","(builtin) FastArrayPush","~makePropertiesGlobal ./usr/lib/node_modules/webppl/src/main.js:35:30","(C++) v8::internal::LookupIterator::State v8::internal::LookupIterator::LookupInSpecialHolder<false>(v8::internal::Map*, v8::internal::JSReceiver*)","~runEvaled ./usr/lib/node_modules/webppl/src/main.js:249:19","~runtimeSetup ./usr/lib/node_modules/webppl/src/main.js:260:22","~init ./usr/lib/node_modules/webppl/src/params/params.js:17:14","~start ./usr/lib/node_modules/webppl/src/params/store/memory.js:21:15","~(anonymous) ./usr/lib/node_modules/webppl/src/params/params.js:22:30","~sync ./usr/lib/node_modules/webppl/src/params/params.js:34:14","~getParams ./usr/lib/node_modules/webppl/src/params/store/memory.js:29:19","~next ./usr/lib/node_modules/webppl/src/params/params.js:36:22","~(anonymous) ./usr/lib/node_modules/webppl/src/main.js:255:32","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:12:29","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:42:20","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:59:41","~env.sample ./usr/lib/node_modules/webppl/src/header.js:85:24","~Initialize.sample ./usr/lib/node_modules/webppl/src/inference/initialize.js:34:41","~Trace.addChoice ./usr/lib/node_modules/webppl/src/trace.js:53:37","~options.score ./usr/lib/node_modules/webppl/src/dists/base.js:96:34","(C++) v8::internal::Runtime_CompileLazy(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Heap::AllocateFeedbackVector(v8::internal::SharedFunctionInfo*, v8::internal::PretenureFlag)","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:388:65","~env.exit ./usr/lib/node_modules/webppl/src/header.js:143:22","~Initialize.exit ./usr/lib/node_modules/webppl/src/inference/initialize.js:59:39","~run ./usr/lib/node_modules/webppl/src/inference/mcmc.js:49:19","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:60:22","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:73:20","~cpsIterate ./usr/lib/node_modules/webppl/src/util.js:127:20","~cpsLoop ./usr/lib/node_modules/webppl/src/util.js:111:17","~loop ./usr/lib/node_modules/webppl/src/util.js:112:16","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:130:15","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:19:20","~MHKernel.run ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:54:36","~MHKernel.resample ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:101:41","~getProposalDist ./usr/lib/node_modules/webppl/src/inference/driftKernel.js:21:27","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:105:79","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:115:70","~MHKernel.addChoiceToTrace ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:130:49","(bytecode) ~LdaImmutableContextSlot","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:117:24","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:385:57","~env.observe ./usr/lib/node_modules/webppl/src/header.js:111:25","~score ./usr/lib/node_modules/webppl/src/dists/binomial.js:68:21","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/func.js:160:17","(stub) GetPropertyStub","~MHKernel.exit ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:141:37","~MHKernel.finish ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:154:39","~MHKernel.continue ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:169:41","~MHKernel.acceptProb ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:206:43","~MHKernel.transitionProb ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:233:47","~copySymbols ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:4794:25","~getSymbols ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6011:62","(bytecode) ~CreateClosure","~MHKernel ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:24:20","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:382:49","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/index.js:140:21","~dist ./usr/lib/node_modules/webppl/src/dists/base.js:112:25","(bytecode) ~JumpIfToBooleanTrue","(C++) v8::internal::TransitionsAccessor::SearchTransition(v8::internal::Name*, v8::internal::PropertyKind, v8::internal::PropertyAttributes)","~initCloneObject ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6167:29","~isPrototype ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6378:25","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/func.js:35:17","(bytecode) ~TestInstanceOf","(bytecode) ~StaNamedPropertyStrict","~keys ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:13306:18","~baseKeys ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:3482:22","(bytecode) ~CallUndefinedReceiver1","~apply ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:471:17","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:12786:37","~keysIn ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:13333:20","~baseKeysIn ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:3502:24","~Trace.findChoice ./usr/lib/node_modules/webppl/src/trace.js:33:38","(bytecode) ~Ldar","(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/func.js:160:17","(bytecode) ~LdaZero","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:383:75","(bytecode) ~CreateFunctionContext","~env.factor ./usr/lib/node_modules/webppl/src/header.js:100:24","~random ./usr/lib/node_modules/webppl/src/util.js:52:16","(bytecode) ~CreateObjectLiteral","(bytecode) ~Wide","(stub) ElementsTransitionAndStoreStub","~baseGetTag ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:3063:24","~objectToString ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:6533:28","(builtin) KeyedStoreIC_Megamorphic_Strict","~Trace.upto ./usr/lib/node_modules/webppl/src/trace.js:107:32","~Trace.fresh ./usr/lib/node_modules/webppl/src/trace.js:24:33","~Trace ./usr/lib/node_modules/webppl/src/trace.js:8:21","~isArrayLike ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:11332:25","(builtin) LoadIC_Noninlined","~isBuffer buffer.js:398:36","score ./usr/lib/node_modules/webppl/src/dists/binomial.js:68:21","(C++) v8::base::ieee754::log(double)","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/func.js:77:17","(IC) A keyed load IC from the snapshot","~Trace.complete ./usr/lib/node_modules/webppl/src/trace.js:95:36","~sample ./usr/lib/node_modules/webppl/src/dists/uniform.js:23:22","(builtin) MathRandom","(builtin) ConstructFunction","(builtin) FunctionPrototypeHasInstance","(C++) v8::internal::Runtime_OrdinaryHasInstance(int, v8::internal::Object**, v8::internal::Isolate*)","~(anonymous) ./usr/lib/node_modules/webppl/src/dists/base.js:115:45","~check ./usr/lib/node_modules/webppl/src/types.js:43:20","(bytecode) ~TestGreaterThanOrEqual","baseClone ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:2620:23","(IC) A load IC from the snapshot","~MHKernel.factor ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:67:39","(bytecode) ~Construct","Query.clear ./usr/lib/node_modules/webppl/src/query.js:20:33","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:61:35","~(anonymous) :1:10","(builtin) MathLog","~isInteger ./usr/lib/node_modules/webppl/src/util.js:279:19","(bytecode) ~TestTypeOf","~lnfactExact ./usr/lib/node_modules/webppl/src/dists/binomial.js:8:21","MHKernel ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:24:20","(builtin) ArgumentsAdaptorTrampoline","MHKernel.run ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:54:36","(builtin) GrowFastSmiOrObjectElements","(anonymous) ./usr/lib/node_modules/webppl/src/util.js:42:20","MHKernel.acceptProb ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:206:43","(builtin) ArrayMap","(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:385:57","(bytecode) ~ForInStep","(bytecode) ~CallProperty","(bytecode) ~CallUndefinedReceiver2","(builtin) CallFunction_ReceiverIsNotNullOrUndefined","(bytecode) ~CreateEmptyArrayLiteral","~binops.mul ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:54:12","(bytecode) ~Mul","(builtin) FastFunctionPrototypeBind","(builtin) Call_ReceiverIsNotNullOrUndefined","(anonymous) :1:10","(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:60:22","(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:19:20","baseKeysIn ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:3502:24","(anonymous) ./usr/lib/node_modules/webppl/src/util.js:130:15","(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:105:79","Trace.addChoice ./usr/lib/node_modules/webppl/src/trace.js:53:37","(builtin) Equal","MHKernel.exit ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:141:37","(C++) v8::base::ieee754::exp(double)","(anonymous) ./usr/lib/node_modules/webppl/src/dists/index.js:140:21","dist ./usr/lib/node_modules/webppl/src/dists/base.js:112:25","(anonymous) ./usr/lib/node_modules/webppl/src/dists/base.js:115:45","~check ./usr/lib/node_modules/webppl/src/types.js:56:20","(C++) v8::internal::Builtin_ArraySlice(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::(anonymous namespace)::ElementsAccessorBase<v8::internal::(anonymous namespace)::FastPackedObjectElementsAccessor, v8::internal::(anonymous namespace)::ElementsKindTraits<(v8::internal::ElementsKind)2> >::Slice(v8::internal::Handle<v8::internal::JSObject>, unsigned int, unsigned int)","(builtin) FastNewClosure","(C++) v8::internal::InnerPointerToCodeCache::GetCacheEntry(unsigned char*)","(stub) RecordWriteStub","MHKernel.addChoiceToTrace ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:130:49","~(anonymous) ./usr/lib/node_modules/webppl/src/math/interval.js:56:20","(bytecode) ~TestLessThanOrEqual","(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:388:65","(C++) v8::internal::(anonymous namespace)::CopyObjectToObjectElements(v8::internal::FixedArrayBase*, v8::internal::ElementsKind, unsigned int, v8::internal::FixedArrayBase*, v8::internal::ElementsKind, unsigned int, int)","(builtin) CompileLazy","(builtin) ObjectPrototypeHasOwnProperty","(anonymous) ./usr/lib/node_modules/webppl/src/util.js:117:24","(anonymous) ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:115:70","(C++) v8::internal::Builtin_ObjectGetOwnPropertySymbols(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Factory::NewJSArrayWithElements(v8::internal::Handle<v8::internal::FixedArrayBase>, v8::internal::ElementsKind, int, v8::internal::PretenureFlag)","MHKernel.transitionProb ./usr/lib/node_modules/webppl/src/inference/mhkernel.js:233:47","(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:382:49","check ./usr/lib/node_modules/webppl/src/types.js:43:20","isArrayLike ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:11332:25","(builtin) Call_ReceiverIsNullOrUndefined","(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:61:35","loop ./usr/lib/node_modules/webppl/src/util.js:112:16","lnfactExact ./usr/lib/node_modules/webppl/src/dists/binomial.js:8:21","score ./usr/lib/node_modules/webppl/src/dists/uniform.js:27:21","~(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:160:10","(C++) v8::internal::Heap::AllocateRaw(int, v8::internal::AllocationSpace, v8::internal::AllocationAlignment)","(anonymous) ./usr/lib/node_modules/webppl/src/inference/kernels.js:50:20","(anonymous) ./usr/lib/node_modules/webppl/src/util.js:131:29","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:116:30","(C++) v8::internal::GetICCounts(v8::internal::JSFunction*, int*, int*, int*, int*, int*)","(builtin) ObjectCreate","(bytecode) ~JumpIfToBooleanFalse","(C++) v8::internal::Heap::AllocateJSObjectFromMap(v8::internal::Map*, v8::internal::PretenureFlag, v8::internal::AllocationSite*)","(builtin) InstanceOf","(builtin) KeyedLoadIC_Megamorphic","(builtin) KeyedStoreIC_Megamorphic","~(anonymous) ./usr/lib/node_modules/webppl/src/util.js:136:15","~(anonymous) ./usr/lib/node_modules/webppl/src/inference/mcmc.js:52:47","baseGetTag ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:3063:24","~noop ./usr/lib/node_modules/webppl/node_modules/lodash/lodash.js:15760:18","(bytecode) ~LdaUndefined","(C++) __pthread_cond_signal","(C++) v8::internal::KeyAccumulator::GetKeys(v8::internal::Handle<v8::internal::JSReceiver>, v8::internal::KeyCollectionMode, v8::internal::PropertyFilter, v8::internal::GetKeysConversion, bool)","(C++) v8::internal::Factory::NewJSArray(v8::internal::ElementsKind, int, int, v8::internal::ArrayStorageAllocationMode, v8::internal::PretenureFlag)","Object native v8natives.js:18:27","check ./usr/lib/node_modules/webppl/src/types.js:56:20","(anonymous) ./usr/lib/node_modules/webppl/src/math/interval.js:56:20","~strictEqual assert.js:638:42","(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:386:82","(C++) v8::internal::KeyAccumulator::CollectOwnPropertyNames(v8::internal::Handle<v8::internal::JSReceiver>, v8::internal::Handle<v8::internal::JSObject>)","(builtin) HasProperty","(C++) v8::internal::Object::OrdinaryHasInstance(v8::internal::Isolate*, v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>)","binops.sub ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:51:12","(C++) v8::internal::Heap::InitializeJSObjectBody(v8::internal::JSObject*, v8::internal::Map*, int)","(C++) v8::internal::Builtin_Impl_ArraySlice(v8::internal::BuiltinArguments, v8::internal::Isolate*)","(builtin) ObjectKeys","(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/func.js:77:17","binops.add ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:48:12","(C++) v8::internal::Runtime_GenerateRandomNumbers(int, v8::internal::Object**, v8::internal::Isolate*)","(builtin) ForInPrepare","(C++) v8::internal::Builtin_ObjectGetPrototypeOf(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Builtin_Impl_ObjectGetPrototypeOf(v8::internal::BuiltinArguments, v8::internal::Isolate*)","(builtin) StrictEqual","(C++) v8::internal::Factory::NewJSObjectFromMap(v8::internal::Handle<v8::internal::Map>, v8::internal::PretenureFlag, v8::internal::Handle<v8::internal::AllocationSite>)","(C++) v8::internal::KeyAccumulator::CollectKeys(v8::internal::Handle<v8::internal::JSReceiver>, v8::internal::Handle<v8::internal::JSReceiver>)","(anonymous) ./usr/lib/node_modules/webppl/node_modules/adnn/ad/functions.js:140:10","(stub) StringAddStub","(stub) StoreBufferOverflowStub","(builtin) JSConstructStubGenericUnrestrictedReturn","(C++) v8::internal::Factory::NewJSArrayStorage(v8::internal::Handle<v8::internal::JSArray>, int, int, v8::internal::ArrayStorageAllocationMode)","(bytecode) ~LdaImmutableCurrentContextSlot","(builtin) Typeof","(C++) v8::internal::FastKeyAccumulator::Prepare()","(stub) ArraySingleArgumentConstructorStub","(IC) prototype","(C++) v8::internal::KeyAccumulator::CollectOwnKeys(v8::internal::Handle<v8::internal::JSReceiver>, v8::internal::Handle<v8::internal::JSObject>)","(builtin) FastNewObject","(C++) v8::internal::FeedbackVector::New(v8::internal::Isolate*, v8::internal::Handle<v8::internal::SharedFunctionInfo>)","~finish ./usr/lib/node_modules/webppl/src/inference/mcmc.js:67:22","~CountAggregator.toDist ./usr/lib/node_modules/webppl/src/aggregation/CountAggregator.js:30:44","(C++) v8::internal::Runtime_NotifyDeoptimized(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::Deoptimizer::VisitAllOptimizedFunctionsForContext(v8::internal::Context*, v8::internal::OptimizedFunctionVisitor*)","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:413:53","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:139:41","(IC) An IC handler from the snapshot","~(anonymous) ./home/anik/Files/work/project/evaluation/profiling/coin.js:92:33","~helper ./home/anik/Files/work/project/evaluation/profiling/coin.js:89:41","(C++) v8::internal::Runtime_LoadIC_Miss(int, v8::internal::Object**, v8::internal::Isolate*)","(C++) v8::internal::IC::UpdateState(v8::internal::Handle<v8::internal::Object>, v8::internal::Handle<v8::internal::Object>)"];
levels = [[0,1,0,0,795,9],[0,1,1,0,790,1,0,1,9,0,1,262,0,3,505],[0,1,2,0,790,2,0,1,55],[0,1,3,0,1,4,0,1,10,0,4,16,0,784,49,0,1,56],[0,1,4,0,1,5,0,1,4,0,4,4,0,784,50,0,1,57],[0,1,5,0,1,13,0,1,5,0,4,5,0,1,51,0,783,52,0,1,58],[0,1,6,0,1,4,0,1,11,0,1,17,0,3,26,0,1,42,0,783,53,0,1,50],[0,1,7,0,1,5,0,1,7,0,1,4,0,2,27,0,1,44,0,1,43,0,783,54,0,1,52],[0,1,8,0,1,14,0,1,12,0,1,5,0,2,28,0,1,45,1,783,55,0,1,53],[1,1,15,1,1,18,0,1,4,0,1,37,0,1,46,1,783,56,0,1,54],[3,1,4,0,1,5,0,1,38,0,1,47,1,65,57,0,718,320,0,1,55],[3,1,5,0,1,29,0,1,39,0,1,48,1,65,58,0,718,321,0,1,59],[3,1,19,0,1,4,0,1,40,2,65,50,0,718,322,0,1,57],[3,1,4,0,1,5,0,1,41,2,65,52,0,718,323,0,1,58],[3,1,5,0,1,30,0,1,42,2,65,53,0,718,324,0,1,50],[3,1,20,0,1,4,0,1,43,2,65,54,0,718,325,0,1,52],[3,1,4,0,1,5,3,65,55,0,718,326,0,1,53],[3,1,5,0,1,31,3,65,59,0,718,327,0,1,54],[3,1,21,0,1,32,3,62,57,0,3,309,0,718,328,0,1,55],[3,1,22,0,1,33,3,62,58,0,2,310,0,1,318,0,718,329,0,1,214],[3,1,23,0,1,34,3,62,50,0,2,33,0,1,97,0,76,330,0,640,436,0,1,473,0,1,483,0,1,215],[3,1,24,0,1,35,3,61,52,0,1,64,0,2,311,0,1,319,0,1,247,0,1,250,0,1,331,0,12,338,0,36,356,0,17,357,0,8,371,3,2,66,0,9,338,0,19,356,0,5,371,0,1,433,0,196,439,0,10,465,0,1,467,0,84,471,0,7,473,0,260,475,0,37,480,0,2,530,0,1,531,0,1,546,0,1,547,0,1,549,2,1,216],[3,1,25,0,1,36,3,61,53,0,1,65,0,2,312,2,1,36,0,1,332,0,12,339,0,36,346,0,17,358,0,1,355,0,5,372,0,1,396,0,1,424,5,9,339,0,19,346,0,1,372,0,4,459,10,2,247,0,164,408,0,14,422,0,2,465,0,4,512,0,1,535,19,1,208,0,2,247,0,1,414,0,1,443,0,3,448,0,7,458,0,4,465,0,45,479,0,7,484,0,5,511,8,9,346,0,250,485,7,29,33,0,1,433,3,1,332,0,1,548,0,1,550,2,1,217],[8,60,54,0,1,61,0,1,148,0,1,57,0,1,314,3,1,333,0,1,340,0,11,362,0,36,347,0,1,247,0,13,335,0,3,394,1,4,373,0,1,392,7,2,362,0,1,448,0,6,457,0,6,347,0,13,453,0,1,373,0,4,460,25,8,66,0,8,247,0,13,378,0,26,390,0,3,409,0,34,410,0,14,422,0,2,428,0,1,442,0,2,483,0,4,486,0,36,520,43,1,522,24,2,409,0,1,417,0,5,422,0,2,438,0,20,463,0,6,487,0,1,247,0,2,473,0,4,490,0,2,180,0,2,255,0,1,304,8,1,255,0,8,453,2,239,453,0,1,465,0,1,483,0,7,500,7,2,433,0,1,443,0,1,448,0,25,461,4,1,355,1,1,551,2,1,218],[8,59,55,0,1,70,0,1,62,0,1,149,0,1,58,0,1,57,3,1,334,0,1,341,0,1,63,0,3,247,0,3,363,0,2,365,0,1,395,0,1,412,0,1,247,0,34,342,0,1,393,1,1,63,0,6,359,0,6,408,0,2,88,0,1,423,1,3,33,0,1,374,0,1,393,7,1,363,0,1,437,2,1,335,0,2,426,0,1,458,0,1,463,0,5,342,0,1,450,0,13,450,0,1,33,0,4,33,41,2,125,0,1,306,0,1,355,0,2,361,0,1,379,0,4,383,0,1,449,0,1,534,4,6,361,0,10,416,0,2,488,0,3,497,0,1,529,3,2,88,0,1,208,0,1,250,0,1,306,0,2,355,0,4,361,0,5,379,0,2,389,0,6,416,0,3,442,0,1,445,0,5,495,0,1,516,14,2,409,5,2,422,6,1,208,0,9,361,0,12,416,0,5,497,0,1,516,0,1,521,0,1,538,43,1,522,26,1,208,7,1,208,0,1,463,0,2,464,0,2,489,0,3,496,0,4,507,0,1,517,0,5,518,0,1,527,2,4,422,3,1,473,0,1,483,0,2,491,14,8,450,4,236,450,0,1,465,2,1,336,0,3,484,0,3,542,16,1,411,0,1,462,0,4,474,0,6,481,0,1,483,0,4,498,0,3,509,6,1,552,2,1,219],[8,14,60,0,1,110,0,4,119,0,4,132,0,9,153,0,6,182,0,1,211,0,1,214,0,1,242,0,3,243,0,2,252,0,13,258,0,1,213,0,1,203,0,1,150,0,1,50,0,1,58,3,1,335,0,1,342,4,1,63,0,2,364,0,2,366,0,1,88,0,1,63,1,34,348,3,1,247,0,1,360,0,1,378,0,1,389,0,1,390,0,1,391,0,1,378,0,1,409,0,3,410,0,1,431,2,1,125,1,1,247,0,2,418,9,1,63,0,1,438,2,1,255,0,1,247,0,1,250,1,1,464,0,5,348,0,1,451,0,11,451,0,2,465,0,1,443,0,3,461,0,1,473,52,1,428,15,5,417,0,1,477,0,2,470,10,1,493,17,3,417,3,1,446,50,7,417,117,1,465,0,1,492,14,8,451,4,1,247,0,3,343,0,1,433,0,221,451,0,6,465,0,3,467,0,1,473,3,1,541,0,3,490,0,3,543,17,1,383,15,3,510,9,1,220],[8,2,57,0,12,67,0,1,111,0,4,120,0,4,133,0,9,57,0,6,57,0,1,57,0,1,215,0,1,57,0,3,57,0,2,57,0,13,57,0,1,197,0,1,163,0,1,151,0,1,52,0,1,50,3,1,336,0,1,343,5,1,63,0,1,426,0,1,63,0,1,335,3,20,349,0,11,370,0,1,415,0,1,432,0,1,434,4,1,361,0,1,379,1,1,247,1,1,427,1,2,361,0,1,416,0,1,390,5,2,419,15,1,466,2,3,432,0,2,434,0,1,432,1,1,421,0,1,422,0,1,432,0,4,454,0,2,463,0,1,467,3,2,462,0,1,474,53,1,409,15,2,208,0,2,417,0,1,515,0,1,208,30,1,208,0,1,417,0,1,515,54,3,417,0,4,515,118,1,369,14,1,422,0,2,432,0,4,454,0,1,467,5,1,88,0,2,344,20,1,33,0,1,208,0,3,236,0,42,421,0,5,422,0,49,432,0,4,447,0,76,454,0,8,463,0,5,465,0,2,467,0,1,498,0,1,526,0,2,532,0,1,537,0,1,540,14,3,501,0,2,373,0,1,460,45,1,221],[8,2,58,0,8,33,0,1,68,0,3,98,0,1,112,0,1,7,0,3,57,0,4,134,0,9,58,0,6,58,0,1,58,0,1,216,0,1,58,0,3,58,0,2,58,0,13,58,2,1,152,0,1,53,0,1,52,3,1,337,0,1,344,6,1,411,1,1,306,3,1,63,0,1,88,0,4,271,0,10,350,0,1,380,0,2,402,0,1,425,0,2,63,0,2,236,0,6,270,0,1,380,1,1,387,0,1,352,9,1,428,3,1,417,0,1,361,5,1,420,0,1,429,19,2,387,0,1,352,0,1,447,0,1,452,1,1,422,1,1,452,0,4,353,0,1,118,0,1,472,4,1,306,0,1,469,304,1,411,0,1,482,0,1,422,0,3,476,7,2,345,36,4,422,0,16,477,0,3,494,0,4,502,0,1,519,0,3,524,19,1,277,0,2,411,0,3,422,0,1,435,0,4,452,0,3,482,0,6,498,0,11,499,0,4,523,11,2,414,0,1,433,0,4,435,0,1,447,0,2,465,0,59,476,0,1,463,0,1,464,0,1,507,0,4,518,0,1,533,27,1,63,0,1,88,0,1,503,0,2,544,0,1,33,45,1,222],[8,2,50,0,8,68,0,1,107,0,3,33,0,1,113,0,1,81,0,3,58,0,1,42,0,1,135,0,2,141,0,9,50,0,6,50,0,1,50,0,1,217,0,1,50,0,3,50,0,2,50,0,13,50,3,1,54,0,1,53,4,1,345,14,3,272,0,1,421,0,8,351,0,2,388,1,1,247,0,1,403,5,6,293,2,1,433,0,1,351,9,1,409,3,1,208,7,1,430,19,1,440,0,1,444,0,1,351,1,1,422,4,2,354,0,2,468,7,1,470,305,1,422,1,2,421,0,1,433,7,2,485,40,2,477,0,4,478,0,1,496,0,3,513,0,2,517,0,1,527,0,1,528,0,1,536,0,1,539,5,1,508,0,1,514,1,2,524,0,1,525,28,2,422,2,1,422,52,2,277,0,4,401,0,24,421,0,5,422,0,1,433,0,3,465,0,9,487,0,1,535,37,1,504,0,2,545,0,1,418,45,1,223],[8,1,52,0,1,64,0,2,69,0,1,79,0,1,82,0,1,86,0,1,89,0,1,91,0,1,95,0,1,68,0,3,99,0,1,114,1,3,50,0,1,140,0,1,136,0,1,142,0,1,144,0,9,52,0,6,52,0,1,64,0,1,218,0,1,64,0,2,52,0,1,64,0,2,52,0,13,52,3,1,70,0,1,54,4,1,346,14,1,273,0,1,376,0,1,407,0,1,422,0,8,352,0,1,389,0,1,411,2,1,404,5,5,384,0,1,398,3,1,353,43,1,353,6,1,247,0,1,455,0,1,277,0,1,422,315,2,477,8,2,453,165,2,422,0,2,456,0,7,477,0,1,494,0,3,502,0,2,524,13,1,409,0,4,422,41,1,544,45,1,224],[8,1,53,0,1,65,0,1,57,0,1,74,0,1,80,0,1,83,0,1,83,0,1,83,0,1,92,0,1,68,0,1,108,0,3,100,0,1,115,1,3,52,1,1,137,0,1,47,0,1,145,0,9,53,0,6,53,0,1,158,0,1,219,0,1,158,0,2,53,0,1,65,0,2,53,0,13,53,3,1,313,0,1,55,4,1,347,14,1,381,0,1,377,0,1,361,1,7,351,0,1,413,4,1,236,5,4,385,0,1,411,4,1,354,43,1,354,7,1,421,317,2,478,8,2,450,169,1,478,0,1,489,0,1,496,0,3,506,0,1,513,1,3,514,0,1,208,0,1,525,59,1,545,45,1,225],[8,1,61,0,1,66,0,1,58,0,1,75,0,1,24,0,1,84,0,1,84,0,1,84,0,1,93,0,1,96,0,1,109,0,2,33,0,1,102,0,1,114,1,3,53,1,1,138,0,1,143,0,1,146,0,9,54,0,6,54,0,1,212,0,1,220,0,1,62,0,2,54,0,1,244,0,2,54,0,13,54,3,1,306,0,1,315,4,1,342,14,1,382,0,1,63,2,7,353,0,1,395,10,3,386,0,1,397,5,1,435,43,1,441,7,1,399,327,2,451,287,1,224],[8,1,62,1,1,50,0,1,76,0,1,81,0,1,7,0,1,75,0,1,77,0,1,7,0,1,83,1,2,101,0,1,97,0,1,116,1,3,54,1,1,139,1,1,147,0,9,55,0,6,55,1,1,221,0,1,203,0,2,55,0,1,149,0,2,55,0,13,55,4,1,57,4,1,348,14,1,383,3,7,354,0,1,414,10,2,387,0,1,405,58,1,456,327,2,454,287,1,226],[8,1,63,1,1,52,0,1,77,1,1,85,0,1,87,0,1,90,0,1,94,0,1,97,1,1,100,0,1,104,0,1,103,0,1,114,1,2,55,0,1,70,4,9,154,0,6,183,1,1,222,0,1,63,0,2,245,0,1,150,0,2,253,0,1,259,0,10,263,0,1,305,0,1,307,4,1,58,4,1,349,18,7,334,11,2,377,0,1,88,386,2,476,287,1,224],[10,1,53,0,1,78,2,1,88,2,1,78,1,1,63,0,1,33,1,1,117,1,2,126,0,1,121,4,9,155,0,6,57,1,1,223,1,2,57,0,1,151,0,2,57,0,1,57,0,9,57,0,1,296,0,1,57,0,1,188,4,1,50,4,1,350,18,1,97,0,1,247,0,2,271,0,2,317,0,1,401,11,1,63,0,1,406,387,1,421,0,1,422,287,1,227],[10,1,54,9,1,105,1,1,7,1,2,127,0,1,122,4,9,57,0,6,58,1,1,224,1,2,58,0,1,62,0,2,58,0,1,58,0,9,58,0,1,297,0,1,58,0,1,73,4,1,316,4,1,351,18,1,375,1,2,272,403,1,477,288,1,228],[10,1,70,9,1,97,1,1,118,1,2,57,0,1,123,4,9,58,0,6,50,1,1,225,1,2,50,0,1,203,0,2,50,0,1,50,0,9,50,0,1,298,0,1,50,0,1,308,4,1,317,4,1,352,20,1,367,0,1,399,403,1,506,288,1,224],[10,1,71,9,1,106,3,2,58,0,1,124,4,9,50,0,6,52,1,1,224,1,2,52,0,1,63,0,2,52,0,1,52,0,8,52,0,1,64,0,1,299,0,1,64,10,1,351,20,1,368,0,1,400,692,1,229],[10,1,72,13,2,50,0,1,125,4,8,52,0,1,64,0,6,53,1,1,226,1,2,53,1,2,53,0,1,53,0,8,53,0,1,65,0,1,300,0,1,158,10,1,353,20,1,369,0,1,205,692,1,224],[10,1,73,13,1,52,0,1,64,5,8,53,0,1,65,0,6,54,1,1,224,1,2,54,1,1,54,0,1,254,0,1,54,0,8,54,0,1,212,0,1,301,0,1,249,10,1,354,714,1,230],[10,1,73,13,1,53,0,1,65,5,8,54,0,1,148,0,6,55,1,1,227,1,2,55,1,1,55,0,1,255,0,1,55,0,8,55,1,1,302,0,1,306,10,1,334,714,1,224],[24,1,61,0,1,128,5,8,55,0,1,149,0,1,184,0,5,193,1,1,228,1,1,246,0,1,248,1,1,256,1,1,260,0,1,264,0,1,265,0,1,268,0,1,278,0,1,281,0,1,283,0,1,285,0,1,292,1,1,303,11,1,271,714,1,231],[24,1,63,0,1,129,5,4,156,0,1,168,0,3,170,0,1,150,0,1,57,0,5,57,1,1,224,1,1,57,0,1,57,1,1,57,1,1,7,0,1,57,0,1,57,0,1,269,0,1,57,0,1,7,0,1,269,0,1,57,0,1,269,1,1,304,11,1,272,714,1,224],[25,1,130,5,4,157,0,1,169,0,3,171,0,1,151,0,1,58,0,5,58,1,1,229,1,1,58,0,1,58,1,1,58,1,1,261,0,1,58,0,1,58,0,1,270,0,1,58,0,1,282,0,1,270,0,1,58,0,1,293,13,1,355,714,1,222],[25,1,131,5,4,57,0,1,57,0,3,57,0,1,97,0,1,50,0,5,50,1,1,224,1,1,50,0,1,50,1,1,50,2,1,50,0,1,50,0,1,271,0,1,50,1,1,271,0,1,50,0,1,294,728,1,223],[31,4,58,0,1,58,0,3,58,0,1,181,0,1,52,0,5,52,1,1,230,1,1,64,0,1,64,1,1,64,2,1,64,0,1,52,0,1,272,0,1,52,1,1,272,0,1,52,0,1,295,728,1,224],[31,4,50,0,1,50,0,3,50,1,1,53,0,5,53,1,1,224,1,1,65,0,1,158,1,1,158,2,1,65,0,1,53,0,1,273,0,1,53,1,1,273,0,1,53,0,1,88,728,1,225],[31,2,52,0,2,64,0,1,64,0,2,52,0,1,64,1,1,54,0,5,54,1,1,231,1,1,148,0,1,249,1,1,257,2,1,175,0,1,54,0,1,274,0,1,54,1,1,274,0,1,54,729,1,224],[31,2,53,0,2,158,0,1,65,0,2,53,0,1,65,1,1,55,0,5,55,1,1,224,1,1,149,0,1,250,4,1,176,0,1,55,0,1,275,0,1,55,1,1,284,0,1,70,729,1,226],[31,1,54,0,1,165,0,1,159,0,1,164,0,1,128,0,2,54,0,1,148,1,1,185,0,5,194,1,1,222,1,1,150,0,1,251,5,1,266,0,1,276,0,1,279,2,1,286,729,1,224],[31,1,55,0,1,166,2,1,129,0,2,55,0,1,149,1,1,186,0,5,57,1,1,223,1,1,247,6,1,57,0,1,277,0,1,57,2,1,287,729,1,227],[31,1,160,0,1,167,2,1,130,0,1,172,0,1,177,0,1,150,1,1,57,0,5,58,1,1,224,8,1,58,1,1,58,2,1,288,729,1,228],[31,1,161,3,1,131,0,1,173,0,1,178,0,1,151,1,1,58,0,5,50,1,1,225,8,1,50,1,1,50,2,1,289,729,1,224],[31,1,57,4,1,57,0,1,57,0,1,175,1,1,50,0,4,52,0,1,64,1,1,224,8,1,64,1,1,64,2,1,290,729,1,229],[31,1,58,4,1,58,0,1,58,0,1,176,1,1,4,0,4,53,0,1,65,1,1,226,8,1,158,1,1,65,2,1,291,729,1,224],[31,1,50,4,1,50,0,1,50,2,1,5,0,4,54,0,1,62,1,1,224,8,1,267,1,1,175,732,1,230],[31,1,52,4,1,52,0,1,64,2,1,187,0,4,55,0,1,203,1,1,227,8,1,163,1,1,280,732,1,232],[31,1,53,4,1,53,0,1,65,2,1,188,0,2,195,0,2,204,0,1,202,1,1,228,743,1,233],[31,1,54,4,1,54,0,1,179,2,1,189,0,2,57,0,2,57,2,1,224,743,1,217],[31,1,55,4,1,70,0,1,180,2,1,190,0,2,58,0,2,58,2,1,229,743,1,218],[31,1,162,4,1,174,3,1,191,0,2,50,0,2,50,2,1,224,743,1,237],[31,1,163,4,1,88,3,1,192,0,2,52,0,1,52,0,1,64,2,1,230,743,1,220],[41,2,53,0,1,53,0,1,65,2,1,232,743,1,221],[41,2,54,0,1,54,0,1,179,2,1,233,743,1,222],[41,2,55,0,1,55,0,1,205,2,1,234,743,1,223],[41,2,196,0,1,206,3,1,235,743,1,224],[41,1,57,0,1,198,0,1,207,3,1,236,743,1,225],[41,1,58,0,1,199,0,1,208,747,1,224],[41,1,50,0,1,200,0,1,209,747,1,226],[41,1,64,0,1,201,0,1,191,747,1,224],[41,1,65,0,1,202,0,1,210,747,1,227],[41,1,62,749,1,228],[41,1,197,749,1,224],[791,1,229],[791,1,224],[791,1,230],[791,1,232],[791,1,233],[791,1,217],[791,1,218],[791,1,237],[791,1,220],[791,1,221],[791,1,222],[791,1,223],[791,1,224],[791,1,225],[791,1,224],[791,1,226],[791,1,224],[791,1,227],[791,1,228],[791,1,224],[791,1,229],[791,1,224],[791,1,230],[791,1,232],[791,1,233],[791,1,217],[791,1,218],[791,1,238],[791,1,220],[791,1,221],[791,1,222],[791,1,223],[791,1,224],[791,1,225],[791,1,224],[791,1,226],[791,1,224],[791,1,227],[791,1,228],[791,1,224],[791,1,229],[791,1,239],[791,1,221],[791,1,222],[791,1,223],[791,1,224],[791,1,225],[791,1,224],[791,1,226],[791,1,224],[791,1,227],[791,1,228],[791,1,224],[791,1,229],[791,1,224],[791,1,230],[791,1,232],[791,1,233],[791,1,234],[791,1,235],[791,1,240],[791,1,241],[791,1,88]];
numTicks = 796;

let rangeMin = 0;
let rangeMax = 1;
let topLevel = 0;
let query = '';
let graphWidth, pxPerTick;

const pxPerLevel = 18;
const collapseThreshold = 5;
const hideThreshold = 0.5;
const labelThreshold = 20;

highlightEl.style.height = pxPerLevel + 'px';

if (levels) {
    init();
}

function init() {
    document.body.classList.add('loaded');

    // delta-decode bar positions
    for (const level of levels) {
        let prev = 0;
        for (let i = 0; i < level.length; i += 3) {
            level[i] += prev;
            prev = level[i] + level[i + 1];
        }
    }

    updateFromHash();
    render();
}

window.onhashchange = () => {
    updateFromHash();
    render();
};
canvas.onclick = (e) => {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);
    if (j === -1) return;
    window.location.hash = [i, j].join(',');
    removeHover();
};
document.getElementById('reset').onclick = () => {
    searchEl.value = query = '';
    window.location.hash = '';
    render();
};
window.onresize = render;

searchEl.oninput = (e) => {
    query = e.target.value;
    render();
};

function updateFromHash() {
    const [i, j] = window.location.hash.substr(1).split(',').map(Number);

    if (!isNaN(i) && !isNaN(j)) {
        topLevel = i;
        rangeMin = levels[i][j] / numTicks;
        rangeMax = (levels[i][j] + levels[i][j + 1]) / numTicks;
    } else {
        topLevel = 0;
        rangeMin = 0;
        rangeMax = 1;
    }
}

function tickToX(i) {
    return (i - numTicks * rangeMin) * pxPerTick;
}

function render() {
    if (!levels) return;

    graphWidth = canvas.width = canvas.clientWidth;
    canvas.height = pxPerLevel * (levels.length - topLevel);
    canvas.style.height = canvas.height + 'px';

    if (devicePixelRatio > 1) {
        canvas.width *= 2;
        canvas.height *= 2;
        ctx.scale(2, 2);
    }

    pxPerTick = graphWidth / numTicks / (rangeMax - rangeMin);

    ctx.textBaseline = 'middle';
    ctx.font = '10px Tahoma, sans-serif';
    ctx.strokeStyle = 'white';

    for (let i = 0; i < levels.length - topLevel; i++) {
        const level = levels[topLevel + i];

        for (let j = 0; j < level.length; j += 3) {
            const barIndex = level[j];
            const x = tickToX(barIndex);
            const y = i * pxPerLevel;
            let numBarTicks = level[j + 1];

            const inQuery = query && (names[level[j + 2]].indexOf(query) >= 0) || false;

            // merge very small blocks into big "collapsed" ones for performance
            const collapsed = numBarTicks * pxPerTick <= collapseThreshold;
            if (collapsed) {
                while (
                    j < level.length - 3 &&
                    barIndex + numBarTicks === level[j + 3] &&
                    level[j + 4] * pxPerTick <= collapseThreshold &&
                    (inQuery === (query && (names[level[j + 5]].indexOf(query) >= 0) || false))
                ) {
                    j += 3;
                    numBarTicks += level[j + 1];
                }
            }

            const sw = numBarTicks * pxPerTick - (collapsed ? 0 : 0.5);
            const sh = pxPerLevel - 0.5;

            if (x < -1 || x + sw > graphWidth + 1 || sw < hideThreshold) continue;

            ctx.beginPath();
            ctx.rect(x, y, sw, sh);

            const ratio = numBarTicks / numTicks;

            if (!collapsed) {
                ctx.stroke();
                const intensity = Math.min(1, ratio * Math.pow(1.16, i) / (rangeMax - rangeMin));
                const h = 50 - 50 * intensity;
                const l = 65 + 7 * intensity;
                ctx.fillStyle = inQuery ? 'lightgreen' : `hsl(${h}, 100%, ${l}%)`;
            } else {
                ctx.fillStyle = inQuery ? 'lightgreen' : '#eee';
            }
            ctx.fill();

            if (!collapsed && sw >= labelThreshold) {

                const percent = Math.round(10000 * ratio) / 100;
                const name = `${names[level[j + 2]]} (${percent}%, ${numBarTicks} samples)`;

                ctx.save();
                ctx.clip();
                ctx.fillStyle = 'black';
                ctx.fillText(name, Math.max(x, 0) + 1, y + sh / 2);
                ctx.restore();
            }
        }
    }
}

// pixel coordinates to bar coordinates in the levels array
function xyToBar(x, y) {
    const i = Math.floor(y / pxPerLevel) + topLevel;
    const j = binarySearchLevel(x, levels[i]);
    return {i, j};
}

// binary search of a block in a stack level
function binarySearchLevel(x, level) {
    let i = 0;
    let j = level.length - 3;
    while (i <= j) {
        const m = 3 * ((i / 3 + j / 3) >> 1);
        const x0 = tickToX(level[m]);
        const x1 = tickToX(level[m] + level[m + 1]);
        if (x0 <= x && x1 >= x) {
            return x1 - x0 > collapseThreshold ? m : -1;
        }
        if (x0 > x) {
            j = m - 3;
        } else {
            i = m + 3;
        }
    }
    return -1;
}

if (window.orientation === undefined) {
    canvas.onmousemove = addHover;
    canvas.onmouseout = window.onscroll = removeHover;
}

function removeHover() {
    canvas.style.cursor = '';
    highlightEl.style.display = 'none';
    tooltipEl.style.display = 'none';
}

function addHover(e) {
    const {i, j} = xyToBar(e.offsetX, e.offsetY);

    if (j === -1 || e.offsetX < 0 || e.offsetX > graphWidth) {
        removeHover();
        return;
    }

    canvas.style.cursor = 'pointer';

    const level = levels[i];
    const x = tickToX(level[j]);
    const y = (i - topLevel) * pxPerLevel;
    const sw = tickToX(level[j] + level[j + 1]) - x;

    highlightEl.style.display = 'block';
    highlightEl.style.left = x + 'px';
    highlightEl.style.top = (canvas.offsetTop + y) + 'px';
    highlightEl.style.width = sw + 'px';

    const numBarTicks = level[j + 1];
    const percent = Math.round(10000 * numBarTicks / numTicks) / 100;
    const time = `<span class="time">(${percent}%, ${numBarTicks} samples)</span>`;
    let content = names[level[j + 2]];
    if (content[0] !== '(') content = content.replace(' ', ` ${time}<br><span class="path">`) + '</span>';
    else content += ` ${time}`;

    tooltipEl.innerHTML = content;
    tooltipEl.style.display = 'block';
    tooltipEl.style.left = (Math.min(e.offsetX + 15 + tooltipEl.clientWidth, graphWidth) - tooltipEl.clientWidth) + 'px';
    tooltipEl.style.top = (canvas.offsetTop + e.offsetY + 12) + 'px';
}

// (function frame() { if (levels) render(); requestAnimationFrame(frame); })();


</script>
</body>
</html>
